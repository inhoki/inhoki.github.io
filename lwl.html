<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./res/css/bootstrap.min.css">
    <title>Laporan Team</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            --margin: 20px;
        }
        #container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            background-color: #f9f9f9;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
        }
        .form-group input,
        .form-group select {
			width: calc(100% - 16px);
            padding: 8px;
            margin-bottom: 10px;
            border-radius: 4px;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }
        .submit-btn, .copy-btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 5px;
            margin-top: 10px;
        }
        .submit-btn:hover, .copy-btn:hover {
            background-color: #45a049;
        }
		.row-rc {
			display: flex;
		}
		.column-25 {
			flex: 25%;
		}
		.column-20 {
			flex: 20%;
		}
		.column-50 {
			flex: 50%;
		}
		.column-75 {
			flex: 75%;
		}
		.column-80 {
			flex: 80%;
		}
        #report {
            margin-top: 30px;
            white-space: pre-line;
            font-family: monospace;
            padding: 10px;
            border: 1px dashed #000;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">inHoki</a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li>
                    <a href="/">Home</a>
                </li>
				<li>
                    <a href="/log">Change Log</a>
                </li>
            </ul>
        </div>
    </div>
</nav>
<div id="container">
	<div class="alert alert-info" role="alert"><strong>Info</strong> untuk saat ini team yang ada masih belum lengkap</div>
    <h2>Laporan Team</h2>
    <form id="reportForm">
        <div class="form-group">
			<div class="row-rc">
				<div class="column-50">
					<label for="shift">Shift (Pagi / Malam):</label>
					<select id="shift" name="shift">
						<option value="1">Pagi</option>
						<option value="2">Malam</option>
					</select>
				</div>
				<div class="column-50">
					<label for="team">Select Team:</label>
					<select id="team" name="team">
						<option value="HOKI88">HOKI88</option>
						<option value="MALAY888">MALAY888</option>
						<option value="DRAGON1131">DRAGON1131</option>
						<option value="MEGABET88">MEGABET88</option>
						<option value="DEWAMALAY88">DEWAMALAY88</option>
						<option value="NAGA1131">NAGA1131</option>
						<option value="LACOSTE128">LACOSTE128</option>
					</select>
				</div>
			</div>
        </div>
        <div class="form-group">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" placeholder="Enter your name" required>
        </div>
        <div class="form-group">
			<div class="row-rc">
				<div class="column-25">
					<label for="value15">Agent <15%>:</label>
					<input type="number" id="value15" name="value15" placeholder="15%" required>
				</div>
				<div class="column-25">
					<label for="value18">Agent <18%>:</label>
					<input type="number" id="value18" name="value18" placeholder="18%" required>
				</div>
				<div class="column-25">
					<label for="value19">Agent <19%>:</label>
					<input type="number" id="value19" name="value19" placeholder="19%" required>
				</div>
				<div class="column-25">
					<label for="value20">Agent <20%>:</label>
					<input type="number" id="value20" name="value20" placeholder="20%" required>
				</div>
			</div>
        </div>
        <button type="button" class="submit-btn" onclick="generateReport()">Submit Report</button>
        <button type="button" class="copy-btn" onclick="copyReport()">Copy Report</button>
    </form>

    <div id="report"></div>
</div>
<script src="./res/js/jquery-1.11.3.min.js"></script>
<script src="./res/js/bootstrap.min.js"></script>
<script>
    function roundNumber(num) {
        return Math.round(num);
    }
	function formatNumber(num, locale = 'id-ID') {
		return num.toLocaleString(locale);
	}
	function plusMinusNum(num) {
		return num >= 0 ? "+ " + formatNumber(num) : formatNumber(num).replace("-", "- ");
	}

    function generateReport() {
        // Get current date
        const today = new Date();
		today.setDate(today.getDate() - 1);
        const formattedDate = today.toLocaleDateString('en-GB'); // Format as DD/MM/YYYY
        
        // Get form values
        const team = document.getElementById('team').value;
        const shift = document.getElementById('shift').value;
        const name = document.getElementById('name').value;
        const value15 = parseFloat(document.getElementById('value15').value) || 0;
        const value18 = parseFloat(document.getElementById('value18').value) || 0;
        const value19 = parseFloat(document.getElementById('value19').value) || 0;
        const value20 = parseFloat(document.getElementById('value20').value) || 0;

        // For <15%> and <16.5%>, result should always be 0
        const diff15 = roundNumber(value15 - (value15 * 0.15));

        // Calculate differences for percentages and round
        const diff18 = roundNumber(value18 - (value18 * 0.18));
        const diff19 = roundNumber(value19 - (value19 * 0.19));
        const diff20 = roundNumber(value20 - (value20 * 0.20));

        // Calculate total sum of the results
        const total = diff15 + diff18 + diff19 + diff20;

        // Create the report text
        const reportText = `LAPORAN TEAM ${team}
${formattedDate} - SHIFT ${shift} ${shift == "1" ? "PAGI" : "MALAM"} ( ${name.toUpperCase()} )

<15%> ${plusMinusNum(value15)} - 15% = (${plusMinusNum(diff15)})
<18%> ${plusMinusNum(value18)} - 18% = (${plusMinusNum(diff18)})
<19%> ${plusMinusNum(value19)} - 19% = (${plusMinusNum(diff19)})
<20%> ${plusMinusNum(value20)} - 20% = (${plusMinusNum(diff20)})

TOTAL: ${plusMinusNum(total)}`;

        // Display the report
        document.getElementById('report').textContent = reportText;
    }

    function copyReport() {
        const reportText = document.getElementById('report').textContent;
        navigator.clipboard.writeText(reportText).then(() => {
            alert("Report copied to clipboard!");
        }).catch(err => {
            alert("Failed to copy: ", err);
        });
    }
</script>
</body>
</html>
